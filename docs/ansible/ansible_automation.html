<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    <title>ansible automation - Kalaxy2 Cluster</title>
    <meta name="description" content="Arm64/Amd64 cluster research">
    <meta name="author" content="Don Buddenbaum">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="icon" href="../themes/daux/img/favicon-blue.png" type="image/x-icon">

    <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- JS -->
    <script>
        window.base_url = "../";
        document.documentElement.classList.remove('no-js');
    </script>

    <!-- Font -->
    
    <!-- CSS -->
            <link href='../themes/daux/css/theme-blue.min.css' rel='stylesheet' type='text/css'>
            <link href='../daux_libraries/search.css' rel='stylesheet' type='text/css'>
    </head>
<body class="">
    <div class="Columns content">
    <aside class="Columns__left Collapsible">
        <button type="button" class="Button Collapsible__trigger" aria-controls="sidebar_content" aria-expanded="false" aria-label="Toggle navigation">
            <span class="Collapsible__trigger__bar"></span>
            <span class="Collapsible__trigger__bar"></span>
            <span class="Collapsible__trigger__bar"></span>
        </button>

        <a class="Brand" href="../index.html">Kalaxy2 Cluster</a>

    <form role='search' action="/" method="get" class="Search" id="search_form">
        <label for="search_input">
            <span class='u-visuallyHidden'>Search</span>
        </label>
        <input
            type="search"
            id="search_input"
            class="Search__field"
            placeholder="Search..."
            aria-label="Search..."
            autocomplete="on"
            results=25
            autosave=text_search
        >
        <label>
            <input type="submit" class='u-visuallyHidden' />
            <span class='u-visuallyHidden'>Search...</span>
            <svg class="Search__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451 451">
                <path d="M447.05 428l-109.6-109.6c29.4-33.8 47.2-77.9 47.2-126.1C384.65 86.2 298.35 0 192.35 0 86.25 0 .05 86.3.05 192.3s86.3 192.3 192.3 192.3c48.2 0 92.3-17.8 126.1-47.2L428.05 447c2.6 2.6 6.1 4 9.5 4s6.9-1.3 9.5-4c5.2-5.2 5.2-13.8 0-19zM26.95 192.3c0-91.2 74.2-165.3 165.3-165.3 91.2 0 165.3 74.2 165.3 165.3s-74.1 165.4-165.3 165.4c-91.1 0-165.3-74.2-165.3-165.4z"/>
            </svg>
        </label>
    </form>

        <div class="Collapsible__content" id="sidebar_content">
            <!-- Navigation -->
            <ul class='Nav'>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>ai</a><ul class='Nav'>
<li class='Nav__item '><a href="../ai/convolutional_neural_network.html">convolutional neural network</a></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>jupyter tensorflow</a><ul class='Nav'>
<li class='Nav__item '><a href="../ai/jupyter_tensorflow/jupyter_tensorflow.html">jupyter tensorflow</a></li></ul></li></ul></li>
<li class='Nav__item Nav__item--open has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>ansible</a><ul class='Nav'>
<li class='Nav__item Nav__item--active'><a href="../ansible/ansible_automation.html">ansible automation</a></li>
<li class='Nav__item '><a href="../ansible/microk8s_setup.html">microk8s setup</a></li>
<li class='Nav__item '><a href="../ansible/storage.html">storage</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>apis</a><ul class='Nav'>
<li class='Nav__item '><a href="../apis/apidog.html">apidog</a></li>
<li class='Nav__item '><a href="../apis/design_patterns.html">design patterns</a></li>
<li class='Nav__item '><a href="../apis/management.html">management</a></li>
<li class='Nav__item '><a href="../apis/microks.html">microks</a></li>
<li class='Nav__item '><a href="../apis/postman.html">postman</a></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>web services</a><ul class='Nav'>
<li class='Nav__item '><a href="../apis/web_services/soap.html">soap</a></li>
<li class='Nav__item '><a href="../apis/web_services/webservices.html">webservices</a></li>
<li class='Nav__item '><a href="../apis/web_services/wsdl.html">wsdl</a></li></ul></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>automation</a><ul class='Nav'>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>argocd</a><ul class='Nav'>
<li class='Nav__item '><a href="../automation/argocd/argocd.html">argocd</a></li>
<li class='Nav__item '><a href="../automation/argocd/argocd_image_updater.html">argocd image updater</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>bpms</a><ul class='Nav'>
<li class='Nav__item '><a href="../automation/bpms/activiti.html">activiti</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>github</a><ul class='Nav'>
<li class='Nav__item '><a href="../automation/github/actions.html">actions</a></li>
<li class='Nav__item '><a href="../automation/github/settings.html">settings</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>helm</a><ul class='Nav'>
<li class='Nav__item '><a href="../automation/helm/helm.html">helm</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>microk8s</a><ul class='Nav'>
<li class='Nav__item '><a href="../automation/microk8s/microk8s_add_ons.html">microk8s add ons</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>slack</a><ul class='Nav'>
<li class='Nav__item '><a href="../automation/slack/slack.html">slack</a></li></ul></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>cicd</a><ul class='Nav'>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>argo gitsctions crossplane</a><ul class='Nav'>
<li class='Nav__item '><a href="../cicd/argo_gitsctions_crossplane/implementation.html">implementation</a></li></ul></li>
<li class='Nav__item '><a href="../cicd/argocd.html">argocd</a></li>
<li class='Nav__item '><a href="../cicd/automation.html">automation</a></li>
<li class='Nav__item '><a href="../cicd/jenkins_argocd.html">jenkins argocd</a></li>
<li class='Nav__item '><a href="../cicd/maven.html">maven</a></li>
<li class='Nav__item '><a href="../cicd/testing.html">testing</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>cloud</a><ul class='Nav'>
<li class='Nav__item '><a href="../cloud/next_cloud.html">next cloud</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>data engineering</a><ul class='Nav'>
<li class='Nav__item '><a href="../data_engineering/deltalake.html">deltalake</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>databases</a><ul class='Nav'>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>clickhouse</a><ul class='Nav'>
<li class='Nav__item '><a href="../databases/clickhouse/docker.html">docker</a></li>
<li class='Nav__item '><a href="../databases/clickhouse/documentation.html">documentation</a></li>
<li class='Nav__item '><a href="../databases/clickhouse/kubernetes_operator.html">kubernetes operator</a></li></ul></li>
<li class='Nav__item '><a href="../databases/cockroachDB.html">cockroachDB</a></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>iris</a><ul class='Nav'>
<li class='Nav__item '><a href="../databases/iris/restapi.html">restapi</a></li></ul></li>
<li class='Nav__item '><a href="../databases/mongodb.html">mongodb</a></li>
<li class='Nav__item '><a href="../databases/mysql.html">mysql</a></li>
<li class='Nav__item '><a href="../databases/performant_datamodels.html">performant datamodels</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>file system</a><ul class='Nav'>
<li class='Nav__item '><a href="../file_system/backup.html">backup</a></li>
<li class='Nav__item '><a href="../file_system/ceph.html">ceph</a></li>
<li class='Nav__item '><a href="../file_system/crd.html">crd</a></li>
<li class='Nav__item '><a href="../file_system/deltalake_vs_parquet.html">deltalake vs parquet</a></li>
<li class='Nav__item '><a href="../file_system/longhorn.html">longhorn</a></li>
<li class='Nav__item '><a href="../file_system/minio.html">minio</a></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>nfs</a><ul class='Nav'>
<li class='Nav__item '><a href="../file_system/nfs/nfs.html">nfs</a></li>
<li class='Nav__item '><a href="../file_system/nfs/nfs_csi.html">nfs-csi</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>object storage</a><ul class='Nav'>
<li class='Nav__item '><a href="../file_system/object_storage/minio.html">minio</a></li></ul></li>
<li class='Nav__item '><a href="../file_system/openebs.html">openebs</a></li>
<li class='Nav__item '><a href="../file_system/rook_ceph.html">rook ceph</a></li>
<li class='Nav__item '><a href="../file_system/samba.html">samba</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>homelab</a><ul class='Nav'>
<li class='Nav__item '><a href="../homelab/cloudflare.html">cloudflare</a></li>
<li class='Nav__item '><a href="../homelab/no_ip.html">no-ip</a></li>
<li class='Nav__item '><a href="../homelab/squarespace.html">squarespace</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>iac</a><ul class='Nav'>
<li class='Nav__item '><a href="../iac/pulumi.html">pulumi</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>id auth</a><ul class='Nav'>
<li class='Nav__item '><a href="../id_auth/zitadel.html">zitadel</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>ideas</a><ul class='Nav'>
<li class='Nav__item '><a href="../ideas/AI_ideas.html">AI ideas</a></li>
<li class='Nav__item '><a href="../ideas/sources.html">sources</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>kubernetes</a><ul class='Nav'>
<li class='Nav__item '><a href="../kubernetes/shell_operator_demo.html">shell-operator-demo</a></li></ul></li>
<li class='Nav__item '><a href="../microk8s.html">microk8s</a></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>ML</a><ul class='Nav'>
<li class='Nav__item '><a href="../ML/pipelines.html">pipelines</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>observability</a><ul class='Nav'>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>grafana</a><ul class='Nav'>
<li class='Nav__item '><a href="../observability/grafana/grafana.html">grafana</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>prometheus</a><ul class='Nav'>
<li class='Nav__item '><a href="../observability/prometheus/prometheus.html">prometheus</a></li></ul></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>operations</a><ul class='Nav'>
<li class='Nav__item '><a href="../operations/crossplane.html">crossplane</a></li>
<li class='Nav__item '><a href="../operations/operators.html">operators</a></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>registries</a><ul class='Nav'>
<li class='Nav__item '><a href="../operations/registries/ghcrIO.html">ghcrIO</a></li></ul></li>
<li class='Nav__item '><a href="../operations/shell_operator.html">shell operator</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>programming</a><ul class='Nav'>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>java</a><ul class='Nav'>
<li class='Nav__item '><a href="../programming/java/java.html">java</a></li>
<li class='Nav__item '><a href="../programming/java/knotes.html">knotes</a></li>
<li class='Nav__item '><a href="../programming/java/spring.html">spring</a></li>
<li class='Nav__item '><a href="../programming/java/springcloud.html">springcloud</a></li>
<li class='Nav__item '><a href="../programming/java/swagger.html">swagger</a></li>
<li class='Nav__item '><a href="../programming/java/webservices.html">webservices</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>nodejs</a><ul class='Nav'>
<li class='Nav__item '><a href="../programming/nodejs/face_recognition.html">face recognition</a></li>
<li class='Nav__item '><a href="../programming/nodejs/frameworks.html">frameworks</a></li>
<li class='Nav__item '><a href="../programming/nodejs/node.html">node</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>playgrounds</a><ul class='Nav'>
<li class='Nav__item '><a href="../programming/playgrounds/kllrcoda.html">kllrcoda</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>python</a><ul class='Nav'>
<li class='Nav__item '><a href="../programming/python/django_cicd_ecom_k8s.html">django cicd ecom k8s</a></li>
<li class='Nav__item '><a href="../programming/python/environment.html">environment</a></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>frameworks</a><ul class='Nav'>
<li class='Nav__item '><a href="../programming/python/frameworks/click.html">click</a></li>
<li class='Nav__item '><a href="../programming/python/frameworks/django.html">django</a></li></ul></li>
<li class='Nav__item '><a href="../programming/python/nicegui.html">nicegui</a></li>
<li class='Nav__item '><a href="../programming/python/pollapp.html">pollapp</a></li></ul></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>project management</a><ul class='Nav'>
<li class='Nav__item '><a href="../project_management/open_project.html">open project</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>references</a><ul class='Nav'>
<li class='Nav__item '><a href="../references/glossary.html">glossary</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>remove</a><ul class='Nav'>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>microk8s</a><ul class='Nav'>
<li class='Nav__item '><a href="../remove/microk8s/microk8s_node.html">microk8s node</a></li></ul></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>setup</a><ul class='Nav'>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>argocd</a><ul class='Nav'>
<li class='Nav__item '><a href="../setup/argocd/argocd.html">argocd</a></li></ul></li>
<li class='Nav__item '><a href="../setup/microk8s.html">microk8s</a></li>
<li class='Nav__item '><a href="../setup/minio.html">minio</a></li>
<li class='Nav__item '><a href="../setup/notes.html">notes</a></li>
<li class='Nav__item '><a href="../setup/podnodeselector.html">podnodeselector</a></li>
<li class='Nav__item '><a href="../setup/README.html">README</a></li>
<li class='Nav__item '><a href="../setup/rpi_usb_ubuntu.html">rpi usb ubuntu</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>standards</a><ul class='Nav'>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>apis</a><ul class='Nav'>
<li class='Nav__item '><a href="../standards/apis/rest_standards.html">rest standards</a></li></ul></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>utilities</a><ul class='Nav'>
<li class='Nav__item '><a href="../utilities/justfile.html">justfile</a></li>
<li class='Nav__item '><a href="../utilities/k8s_cmd_ref.html">k8s cmd ref</a></li>
<li class='Nav__item '><a href="../utilities/k8s_troubleshooting.html">k8s troubleshooting</a></li>
<li class='Nav__item '><a href="../utilities/k9s.html">k9s</a></li>
<li class='Nav__item '><a href="../utilities/kube_shark.html">kube shark</a></li>
<li class='Nav__item '><a href="../utilities/pvc_backup.html">pvc backup</a></li>
<li class='Nav__item '><a href="../utilities/taskfile.html">taskfile</a></li>
<li class='Nav__item '><a href="../utilities/utilities.html">utilities</a></li></ul></li>
<li class='Nav__item  has-children'><a href="#" class="Nav__item__link Nav__item__link--nopage"><i class="Nav__arrow">&nbsp;</i>websites generation</a><ul class='Nav'>
<li class='Nav__item '><a href="../websites_generation/dauxio_kalaxy2.html">dauxio kalaxy2</a></li>
<li class='Nav__item '><a href="../websites_generation/resume.html">resume</a></li></ul></li></ul>
            <div class="Links">
                            </div>

                            <div class="CodeToggler">
                    <hr/>
                    <label class="Checkbox">Show Code Blocks                        <input type="checkbox" class="CodeToggler__button--main" checked="checked"/>
                        <div class="Checkbox__indicator"></div>
                    </label>
                </div>
            
            <div class="DarkModeToggler">
                <hr/>
                <label class="Checkbox">Dark Mode                    <input type="checkbox" class="ColorMode__button" />
                    <div class="Checkbox__indicator"></div>
                </label>
            </div>

                
                        </div>
    </aside>
    <div class="Columns__right">
        <div class="Columns__right__content">
            <div class="doc_content">
                <article class="Page">

    <div class="Page__header">
        <h1><a href="../ansible/ansible_automation.html">ansible</a> <svg class="Page__header--separator" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 477.175 477.175"><path d="M360.73 229.075l-225.1-225.1c-5.3-5.3-13.8-5.3-19.1 0s-5.3 13.8 0 19.1l215.5 215.5-215.5 215.5c-5.3 5.3-5.3 13.8 0 19.1 2.6 2.6 6.1 4 9.5 4 3.4 0 6.9-1.3 9.5-4l225.1-225.1c5.3-5.2 5.3-13.8.1-19z"/></svg> <a href="../ansible/ansible_automation.html">ansible automation</a></h1>
                    </div>

    <div class="s-content">
        <div class="TableOfContentsContainer">
    <h4 class="TableOfContentsContainer__title">Table of Contents</h4>
    <div class="TableOfContentsContainer__content">
        <ul class="TableOfContents">
<li>
<a href="#anisble-automation">Anisble Automation</a>
</li>
<li>
<a href="#ansible-role-microk8s">Ansible Role: microk8s</a>
<ul>
<li>
<a href="#requirements">Requirements</a>
</li>
<li>
<a href="#license">License</a>
</li>
<li>
<a href="#usage">Usage</a>
<ul>
<li>
<a href="#role-variables">Role Variables</a>
</li>
<li>
<a href="#basic-playbook">Basic playbook</a>
</li>
<li>
<a href="#custom-certificate-request-template">Custom certificate request template</a>
</li>
<li>
<a href="#adding-worker-only-nodes-1-23-only">Adding worker only nodes (1.23+ only)</a>
</li>
</ul>
</li>
<li>
<a href="#testing">Testing</a>
<ul>
<li>
<a href="#using-molecule-wrapper-and-system-python">Using Molecule wrapper and system Python</a>
</li>
<li>
<a href="#using-python-virtual-environment">Using Python virtual environment</a>
</li>
</ul>
</li>
<li>
<a href="#create-partitions">Create partitions</a>
</li>
<li>
<a href="#microk8s">MicroK8s</a>
</li>
<li>
<a href="#community-play-books">Community play books</a>
</li>
<li>
<a href="#storage-role">Storage role</a>
</li>
</ul>
</li>
</ul>    </div>
</div>
<h1><a id="anisble-automation" href="#anisble-automation" class="Permalink" aria-hidden="true" title="Permalink">#</a>Anisble Automation</h1>
<p><a href="https://shashwotrisal.medium.com/kubernetes-with-ansible-881f32b8c53e" class="Link--external" rel="noopener noreferrer">Kubernetes With Ansible</a></p>
<h1><a id="ansible-role-microk8s" href="#ansible-role-microk8s" class="Permalink" aria-hidden="true" title="Permalink">#</a>Ansible Role: microk8s</h1>
<ul>
<li>
<p><a href="https://github.com/istvano/ansible_role_microk8s" class="Link--external" rel="noopener noreferrer">istvano/ansible_role_microk8s</a></p>
</li>
<li>
<p><a href="https://github.com/cloud-native-skunkworks/microk8s-ansible" class="Link--external" rel="noopener noreferrer">cloud-native-skunkworks/microk8s-ansible</a></p>
</li>
<li>
<p>Role to download and install <a href="https://microk8s.io/" class="Link--external" rel="noopener noreferrer">microk8s</a> the smallest, simplest, pure production K8s.</p>
</li>
</ul>
<h2><a id="requirements" href="#requirements" class="Permalink" aria-hidden="true" title="Permalink">#</a>Requirements</h2>
<ul>
<li>Ansible &gt;= 2.7</li>
<li>Linux Distribution
<ul>
<li>Debian Family
<ul>
<li>Ubuntu
<ul>
<li>Xenial (16.04)</li>
<li>Bionic (18.04)</li>
<li>Focal  (20.04)</li>
</ul>
</li>
</ul>
</li>
<li>Arch Linux (untested)</li>
</ul>
</li>
</ul>
<h2><a id="license" href="#license" class="Permalink" aria-hidden="true" title="Permalink">#</a>License</h2>
<p>MIT</p>
<h2><a id="usage" href="#usage" class="Permalink" aria-hidden="true" title="Permalink">#</a>Usage</h2>
<h3><a id="role-variables" href="#role-variables" class="Permalink" aria-hidden="true" title="Permalink">#</a>Role Variables</h3>
<p>Some variables available in this role are listed here.  The full set is
defined in <code>[defaults/main.yml](defaults/main.yml)</code>.</p>
<ul>
<li>
<code>microk8s_version</code>: Version to use, defaults to <code>1.19/stable</code>.</li>
<li>
<code>microk8s_plugins</code>: Enable/disable various plugins. A string will be passed as <code>arg</code> when enabling addon using <code>name:arg</code>
</li>
<li>
<code>microk8s_enable_HA</code>: Enable/disable high-availability.</li>
<li>
<code>microk8s_group_HA</code>: Hostgroup whose members will form HA cluster.</li>
<li>
<code>microk8s_group_WORKERS</code>: Hostgroup whose members will act as worker nodes only (no control-plane components run here)</li>
<li>
<code>microk8s_csr_template</code>: If defined, will cause a custom CSR to be used in
generating certificates.</li>
</ul>
<h3><a id="basic-playbook" href="#basic-playbook" class="Permalink" aria-hidden="true" title="Permalink">#</a>Basic playbook</h3>
<pre><code class="hljs yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">hosts:</span> <span class="hljs-string">servers</span>
  <span class="hljs-attr">roles:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">role:</span> <span class="hljs-string">istvano.microk8s</span>
      <span class="hljs-attr">vars:</span>
        <span class="hljs-attr">microk8s_plugins:</span>
          <span class="hljs-attr">dns:</span> <span class="hljs-string">"1.1.1.1"</span>
          <span class="hljs-attr">istio:</span> <span class="hljs-literal">true</span>
          <span class="hljs-attr">ingress:</span> <span class="hljs-literal">true</span>
</code></pre>
<h3><a id="custom-certificate-request-template" href="#custom-certificate-request-template" class="Permalink" aria-hidden="true" title="Permalink">#</a>Custom certificate request template</h3>
<p>It might be useful to customize the certificate request template used by
MicroK8s in generating cluster certificates.  For example, additional SANs can
be added to the certificates such that the MicroK8s certificates validate when
addressed from outside the cluster, such as through a reverse proxy.</p>
<p>To generate a CSR template, the easiest is probably to use the role without
a template, and then copy the CSR in
<code>/var/snap/microk8s/current/certs/csr.conf.template</code> to your playbookâ€™s
templates directory, make the edits and set the <code>microk8s_csr_template</code>
variable accordingly, and re-run the playbook.</p>
<h3><a id="adding-worker-only-nodes-1-23-only" href="#adding-worker-only-nodes-1-23-only" class="Permalink" aria-hidden="true" title="Permalink">#</a>Adding worker only nodes (1.23+ only)</h3>
<p>It is possible to configure additional nodes to act as workers only within your microk8s cluster. This is possible by configuring the ansible hostgroup <code>microk8s_WORKERS</code> (name of the group is configurable via <code>microk8s_group_WORKERS</code>). Every host listed within the hostgroup will essentially run <code>microk8s join .... --worker</code>, more info on this can be found here: <a href="https://microk8s.io/docs/clustering" class="Link--external" rel="noopener noreferrer">microk8s-clustering</a>.</p>
<h2><a id="testing" href="#testing" class="Permalink" aria-hidden="true" title="Permalink">#</a>Testing</h2>
<h3><a id="using-molecule-wrapper-and-system-python" href="#using-molecule-wrapper-and-system-python" class="Permalink" aria-hidden="true" title="Permalink">#</a>Using Molecule wrapper and system Python</h3>
<ul>
<li>
<code>./moleculew lint</code>
</li>
<li>
<code>./moleculew create</code>
</li>
<li>
<code>./moleculew list</code>
</li>
<li>
<code>./moleculew check</code>
</li>
<li>
<code>./moleculew test</code>
</li>
</ul>
<h3><a id="using-python-virtual-environment" href="#using-python-virtual-environment" class="Permalink" aria-hidden="true" title="Permalink">#</a>Using Python virtual environment</h3>
<ul>
<li>Set up virtual environment
<pre><code>$ python3 -m venv venv
</code></pre>
</li>
<li>Activate the environment
<pre><code>$ . venv/bin/activate
</code></pre>
</li>
<li>Install Molecule with lint and Docker options
<pre><code>$ pip install 'molecule[lint,docker]'
</code></pre>
</li>
<li>Install up-to-date Ansible package if necessary
<pre><code>$ pip install ansible
</code></pre>
</li>
<li>Run the test commands:
<ul>
<li>
<code>molecule lint</code>
</li>
<li>
<code>molecule create</code>
</li>
<li>
<code>molecule list</code>
</li>
<li>
<code>molecule check</code>
</li>
<li>
<code>molecule test</code>
</li>
</ul>
</li>
</ul>
<h2><a id="create-partitions" href="#create-partitions" class="Permalink" aria-hidden="true" title="Permalink">#</a>Create partitions</h2>
<p><a href="https://www.programmersought.com/article/28993871391/" class="Link--external" rel="noopener noreferrer">ansible disk partition management using playbook</a></p>
<h2><a id="microk8s" href="#microk8s" class="Permalink" aria-hidden="true" title="Permalink">#</a>MicroK8s</h2>
<p><a href="https://github.com/istvano/ansible_role_microk8s" class="Link--external" rel="noopener noreferrer">Ansible Role: microk8s</a></p>
<h2><a id="community-play-books" href="#community-play-books" class="Permalink" aria-hidden="true" title="Permalink">#</a>Community play books</h2>
<p><a href="https://docs.ansible.com/ansible/latest/collections/community/general/parted_module.html#return-partition_info/disk" class="Link--external" rel="noopener noreferrer">Community play books</a></p>
<h2><a id="storage-role" href="#storage-role" class="Permalink" aria-hidden="true" title="Permalink">#</a>Storage role</h2>
<p><a href="https://storageapis.wordpress.com/2022/01/28/simple-partitioning-with-ansible-storage-role/" class="Link--external" rel="noopener noreferrer">Simple Partitioning with Ansible Storage Role</a></p>
    </div>

        <nav>
        <ul class="Pager">
            <li class=Pager--prev><a href="../ai/jupyter_tensorflow/jupyter_tensorflow.html">Previous</a></li>            <li class=Pager--next><a href="../ansible/microk8s_setup.html">Next</a></li>        </ul>
    </nav>
    </article>

            </div>
        </div>
    </div>
</div>

    
    <!-- JS -->
            <script src="../themes/daux/js/main.mjs"></script>
    
        <script>
        
        window.searchLanguage = "";
        window.searchTranslation = {"Search_one_result":"1 result","Search_results":"!count results","Search_no_results":"Nothing found","Search_common_words_ignored":"Common words are largely ignored","Search_too_short":"Search too short","Search_one_character_or_more":"Should be one character or more","Search_should_be_x_or_more":"Should be !min characters or more","Link_previous":"Previous","Link_next":"Next"};
    </script>

    <!-- Search -->
    <script type="text/javascript" src="../daux_libraries/search.min.js"></script>

    <script>
        window.search({'base_url': '../'})
    </script>
</body>
</html>
